(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"9zIH":function(t,e,r){"use strict";r.r(e);var n=r("o0o1"),o=r.n(n),i=r("DUG2"),a=(r("URgk"),r("ta7f"));function c(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function s(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function a(t){c(i,n,o,a,s,"next",t)}function s(t){c(i,n,o,a,s,"throw",t)}a(void 0)})}}var u,p,d,l={name:"Create",components:{"treeview-categories":function(){return r.e(5).then(r.bind(null,"a6QB"))}},data:function(){return{loading:!1,products:[],form:{name:"",price:0,description:"",images:[],children:[],kit:!1,category_id:null}}},watch:{"form.kit":(d=s(o.a.mark(function t(e){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=3;break}return t.next=3,this.readyProducts();case 3:case"end":return t.stop()}},t,this)})),function(t){return d.apply(this,arguments)})},computed:{nameErrors:function(){var t=[],e=this.$v.form.name;return e.$dirty?(!e.required&&t.push("Informe o nome do produto."),t):[]},priceErrors:function(){var t=[],e=this.$v.form.price;return e.$dirty?(!e.required&&t.push("Informe o valor do produto."),t):[]},categoryIdErrors:function(){var t=[],e=this.$v.form.category_id;return e.$dirty?(!e.required&&t.push("Informe a categoria do produto."),t):[]}},validations:{form:{name:{required:a.required},price:{required:a.required},category_id:{required:a.required}}},methods:{send:(p=s(o.a.mark(function t(e){var r,n,a,c,s,u,p,d,l=this;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.loading=!0,e.kit=e.kit?1:0,r=e.name,n=e.price,a=e.description,c=e.category_id,s=e.kit,u=e.images,p=e.children,(d=new FormData).append("name",r),d.append("price",n),d.append("description",a),d.append("category_id",c),d.append("kit",s),u.forEach(function(t){return d.append("images[]",t)}),p.forEach(function(t){var e=t.id,r=t.quantity;d.append("children[".concat(e,"]"),JSON.stringify({quantity:r}))}),t.next=12,Object(i.d)(d).then(function(){alert("Produto cadastrado."),l.reset()}).catch(function(t){403===t.response.status&&l.$emit("page","error")}).finally(function(){return l.loading=!1});case 12:case"end":return t.stop()}},t,this)})),function(t){return p.apply(this,arguments)}),reset:function(){this.form={name:"",price:"",description:"",images:[],children:[],kit:!1,category_id:""},this.$v.form.$reset()},setCategoryProduct:function(t){this.form.category_id=t,this.$v.form.category_id.$touch()},readyProducts:(u=s(o.a.mark(function t(){var e=this;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.loading=!0,t.next=3,Object(i.c)("orderBy[price]=asc").then(function(t){var r=t.data;e.products=r.map(function(t){return t.quantity=1,t})}).finally(function(){return e.loading=!1});case 3:case"end":return t.stop()}},t,this)})),function(){return u.apply(this,arguments)})}},f=(r("MlaN"),r("KHd+")),v=Object(f.a)(l,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-container",{attrs:{"fill-height":""}},[r("v-layout",{attrs:{row:"",wrap:"","justify-center":""}},[r("v-flex",{attrs:{xs12:"",sm12:"",md8:""}},[r("v-card",{ref:"form",attrs:{tag:"form",enctype:"multipart/form-data",autocomplete:"off"},on:{submit:function(e){return e.preventDefault(),t.send(t.form)}}},[r("v-toolbar",{attrs:{color:"transparent",flat:"",tile:""}},[r("v-toolbar-title",[t._v("Adicionar Produto")]),t._v(" "),r("v-spacer"),t._v(" "),r("v-toolbar-items",[r("v-btn",{attrs:{type:"button",disabled:t.loading,text:""},on:{click:t.reset}},[t._v("Cancelar")]),t._v(" "),r("v-btn",{attrs:{type:"submit",disabled:t.loading||t.$v.form.$invalid,loading:t.loading,color:"success",text:""}},[t._v("Salvar")])],1)],1),t._v(" "),r("v-divider"),t._v(" "),r("v-card-text",[r("v-text-field",{attrs:{label:"Produto (*)",placeholder:"Nome do produto","error-messages":t.nameErrors},on:{input:t.$v.form.name.$touch},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name","string"==typeof e?e.trim():e)},expression:"form.name"}}),t._v(" "),r("v-text-field",{attrs:{label:"Preço (*)",placeholder:"Valor do produto","error-messages":t.priceErrors},on:{input:t.$v.form.price.$touch},model:{value:t.form.price,callback:function(e){t.$set(t.form,"price","string"==typeof e?e.trim():e)},expression:"form.price"}}),t._v(" "),r("v-file-input",{attrs:{color:"primary accent-2",label:"Imagens",multiple:"",placeholder:"Selecione as imagens","prepend-icon":"mdi-paperclip",accept:"image/*","display-size":1e3,counter:""},scopedSlots:t._u([{key:"selection",fn:function(e){var n=e.index,o=e.text;return[n<2?r("v-chip",{attrs:{color:"primary accent-4",dark:"",label:"",small:""}},[t._v(t._s(o))]):2===n?r("span",{staticClass:"overline grey--text text--darken-3 mx-2"},[t._v("+"+t._s(t.files.length-2)+" Imagens(s)")]):t._e()]}}]),model:{value:t.form.images,callback:function(e){t.$set(t.form,"images",e)},expression:"form.images"}}),t._v(" "),r("v-switch",{attrs:{label:"Produto Kit?",color:"primary"},model:{value:t.form.kit,callback:function(e){t.$set(t.form,"kit",e)},expression:"form.kit"}}),t._v(" "),r("v-expand-transition",[t.form.kit?r("v-autocomplete",{attrs:{label:"Produtos filhos",items:t.products,"item-text":"name","return-object":"",multiple:"",loading:t.loading},model:{value:t.form.children,callback:function(e){t.$set(t.form,"children",e)},expression:"form.children"}}):t._e()],1),t._v(" "),t.form.children.length>0?r("v-list",{attrs:{"two-line":"",color:"grey lighten-4"}},t._l(t.form.children,function(e,n){return r("v-list-item",{key:n},[r("v-list-item-content",[r("v-list-item-title",[r("span",[t._v(t._s(e.name))]),t._v(" "),r("span",{staticClass:"px-1"},[t._v("-")]),t._v(" "),r("span",[t._v("R$ "+t._s(e.price)+" (unidade)")])]),t._v(" "),r("v-list-item-subtitle",{domProps:{textContent:t._s(e.description)}})],1),t._v(" "),r("v-list-item-action",[r("v-input",{scopedSlots:t._u([{key:"prepend",fn:function(){return[r("v-icon",{on:{click:function(t){e.quantity>1&&e.quantity--}}},[t._v("mdi-minus")])]},proxy:!0},{key:"append",fn:function(){return[r("v-icon",{on:{click:function(t){e.quantity++}}},[t._v("mdi-plus")])]},proxy:!0}],null,!0)},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.quantity,expression:"child.quantity"}],staticClass:"native text-xs-center",attrs:{readonly:""},domProps:{value:e.quantity},on:{input:function(r){r.target.composing||t.$set(e,"quantity",r.target.value)}}})])],1)],1)}),1):t._e(),t._v(" "),r("treeview-categories",{on:{category:t.setCategoryProduct}}),t._v(" "),r("v-textarea",{attrs:{label:"Descrição do produto",counter:""},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description","string"==typeof e?e.trim():e)},expression:"form.description"}})],1)],1)],1)],1)],1)},[],!1,null,"33aaa930",null);e.default=v.exports},DUG2:function(t,e,r){"use strict";r.d(e,"b",function(){return c}),r.d(e,"c",function(){return s}),r.d(e,"d",function(){return u}),r.d(e,"a",function(){return p});var n=r("o0o1"),o=r.n(n);function i(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function a(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var a=t.apply(e,r);function c(t){i(a,n,o,c,s,"next",t)}function s(t){i(a,n,o,c,s,"throw",t)}c(void 0)})}}var c=function(){var t=a(o.a.mark(function t(){var e,r,n=arguments;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:1,r=n.length>1&&void 0!==n[1]?n[1]:6,t.next=4,axios.get("api/products/?page=".concat(e,"&paginate=").concat(r,"&with[children]=*&orderBy[kit]=desc"));case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),s=function(){var t=a(o.a.mark(function t(e){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,axios.get("api/products/?".concat(e));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),u=function(){var t=a(o.a.mark(function t(e){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,axios.post("api/products",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),p=function(){var t=a(o.a.mark(function t(e){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,axios.delete("api/products/".concat(e));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},MlaN:function(t,e,r){"use strict";var n=r("Wowx");r.n(n).a},Wowx:function(t,e,r){var n=r("fuDg");"string"==typeof n&&(n=[[t.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};r("aET+")(n,o);n.locals&&(t.exports=n.locals)},fuDg:function(t,e,r){(t.exports=r("I1BE")(!1)).push([t.i,"input.native[data-v-33aaa930] {\n  width: 35px;\n  height: 50px;\n}\ninput.native[data-v-33aaa930]:focus, input.native[data-v-33aaa930]:active {\n  outline: 0;\n  box-shadow: none;\n  border-color: none;\n}",""])}}]);